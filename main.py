from getpass import getpass
from pathlib import Path

from selenium import webdriver
from selenium.webdriver.support.ui import WebDriverWait
from urllib.request import Request, urlopen

from selenium.webdriver.common.by import By
from slugify import slugify
from selenium.webdriver.firefox.options import Options

url_base = 'http://spiunet.spu.planejamento.gov.br'


# options = Options()
# Firefox
# options.binary_location = r"C:\Program Files\Mozilla Firefox\firefox.exe"
# driver = webdriver.Firefox(options=options)


# driver.get(url+'/consulta/Cons_PedRip.asp')
# driver.find_element_by_xpath('/html/body/form/div[1]/table/tbody/tr[2]/td/p/input[1]').send_keys('9701326175000')
# driver.find_element_by_xpath('/html/body/form/div[1]/table/tbody/tr[2]/td/p/input[2]').click()

# def trata_dados_url_imovel():


def acessa_rips_municipio(rips_urls, driver):
    for rip_url in rips_urls:
        driver.get(rip_url)
        url_current = driver.current_url
        if url_current.find('Cons_Imovel.asp') != -1:
            # parei aqui
            print("Imóvel")

        if url_current.find('Cons_Utilizacao.asp') != -1:
            print("Utilização")


def consulta_por_municipio(driver):
    #codmunicipio = ["0870","0460","6797","5489","3691","4177","4951","9025","5393","1273","0699","0983","7947","9415","0767","5741","7083","1148","0189","0248","4101","4549","6955","8787","6339","3237","3681","3803","2573","7791","7707","4811","6481","2317","0746","4477","9409","0109","3327","2957","9641","6011","7349","9223","2045","2655","2001","1755","2773","0771","2687","4153","1114","6599","2765","1255","5615","6715","6659","3437","9183","7469","4939","0451","4569","4853","0550","6931","5539","5167","1024","5243","9727","0976","7927","1012","8251","6329","1761","4655","8487","4327","0024","0979","4649","2729","0159","3707","6235","0279","0197","9251","9699","2273","0372","9607","5037","0360","0520","0274","0089","7959","6489","9221","2809","0994","0727","1461","2357","8393","2519","1087","2349","8465","6629","7647","5971","0118","5725","3357","8495","6985","0989","2987","0148","7387","5591","0676","5015","5137","1587","6073","4359","5497","1823","6593","2549","3649","0873","0463","4295","2785","5351","5715","3227","2531","4651","5545","2649","3055","9495","6027","8963","9043","3861","8877","8463","7237","0955","0421","8289","4453","6777","7141","3103","6603","4277","4355","0948","0784","8021","2759","2389","5323","5853","8665","6381","5155","6215","8009","3887","5885","9391","0785","5475","3271","0293","3759","6937","5467","1221","1078","9213","1015","4889","8313","1991","2153","2927","4433","9041","7817","0027","1943","1022","9565","8667","5765","0600","1067","7755","8081","6123","3307","7017","4405","9949","2281","7215","0016","0071","5165","5531","7161","6017","2017","6135","1035","0991","3193","2335","0560","0920","3009","1579","6391","6103","7119","6915","6787","9397","8535","1925","1435","4981","7467","0826","2233","2109","0126","6875","9809","2753","7109","8167","2905","1597","6651","7751","0531","9053","1669","3581","6923","0702","0029","0151","2149","4065","5287","9079","7805","0558","9795","0045","1999","6973","1179","8193","6439","8967","0830","7661","0582","1499","3497","9609","2227","6917","6459","0072","3149","5963","1351","6775","4937","6935","5955","7539","5901","4061","3653","5447","1487","9969","1016","0890","8291","3637","5023","2981","5795","5507","7705","0851","4643","5131","8227","9321","5487","5975","4097","4621","9555","4863","4455","9715","1088","0678","4531","3917","2199","2319","4471","9161","0921","4671","0490","8055","2303","6585","3115","5845","0787","0335","9387","7429","0047","4941","4737","8203","0306","2079","6111","0355","7445","2631","3075","1136","8579","8905","5967","5309","2697","4899","0041","1835","5055","5821","9939","5777","9769","2305","2711","8297","0303","1361","3359","1319","6213","0543","3355","9551","7591","4571","4367","0632","8717","9653","0660","0721","9489","5327","5775","7305","4813","5587","4525","7703","7499","8517","0237","0235","1108","0715","1405","1075","0798","6281","3059","0956","6233","1030","7491","9815","1821","0307","0753","2913","3727","3033","4663","3517","0886","4287","0922","5265","0003","2937","6689","0142","0365","4523","1051","6801","8709","0202","5565","5523","2831","0074","4293","6365","8035","3301","2645","1215","8637","7657","5617","7369","7813","5651","0610","5075","5357","9067","7311","8573","0640","4493","3839","7465","7913","4527","0100","0487","2849","7211","0744","0559","1373","6633","0831","0055","6657","6901","0352","5913","1465","7011","3850","9049","0847","7617","4475","0090","7695","0618","2147","3941","0168","8753","8425","9077","5649","4217","1933","7765","0097","3849","6295","8802","2215","6415","4335","0032","5385","9871","1082","0794","5503","2077","4073","4273","0378","2965","2841","1861","0044","0450","8749","1773","8705","4993","1767","1027","0760","0819","2817","6605","9745","3787","1196","0338","0805","3211","1457","4879","6957","0349","8747","2099","4667","4259","7847","5073","0627","3439","7637","5883","8653","4411","0413","2203","5995","3627","5869","9619","0849","4437","0458","4389","1365","0671","9357","9435","7151","1155","1803","7917","8283","0636","8771","6159","1080","3139","8233","1013","7983","9247","0927","9163","2839","0816","8993","7031","0852","1931","4417","0154","3841","3553","6929","4885","5817","0637","8467","8259","4301","5687","0034","7273","2581","8127","3269","5347","4855","5383","7951","1118","2605","9579","4929","7415","5375","3335","7613","7001","1739","8509","2879","7365","6873","5729","3037","0665","8861","5149","6005","7023","5799","3019","6401","3461","9821","6883","0908","7739","1152","4231","1028","4637","6471","4835","9239","6503","0934","0907","2579","8247","2323","4239","7989","7743","2052","7945","6925","3253","8307","4755","1573","7405","4791","1096","9433","8249","5965","0966","0924","4817","8075","0529","9701","2155","3051","0298","0357","9655","7575","4189","0170","4467","7153","6255","7193","5031","2541","6129","5389","1677","1429","9091","2647","1585","1489","1569","1018","7521","9927","0545","3889","1357","8657","7309","9143","0638","0270","7631","9381","7747","3749","7337","0647","6927","0889","0765","0128","1331","9403","5201","7607","4181","1693","7075","3401","5193","0747","9393","0604","7019","1471","9667","9747","1915","3871","0445","3381","9209","1049","2313","0620","0675","7321","5279","4381","5849","1197","0381","8863","0400","2255","9473","2411","0962","4775","6161","6201","0266","5465","7013","4075","0914","0258","1093","0521","5455","0906","7367","8223","4959","0158","6497","9515","1105","2523","8273","0891","3297","8675","3699","9733","6429","0454","1081","7809","8623","0833","7969","0974","5113","9637","4779","4695","0779","8405","3629","5217","4727","9009","6357","4723","7495","0759","8793","8955","1977","4831","1485","3153","0682","7513","3067","5717","8733","7589","6279","1425","5051","2439","6881","8389","3615","8549","2309","7931","1527","0915","0242","3197","4869","9191","4213","6209","0539","8041","3755","1593","2855","6321","8849","8683","0056","7779","0866","0557","3493","6385","0101","6543","0341","3847","3273","4577","0844","5469","9587","1715","3427","8769","1753","3423","7175","3625","5297","0073","6965","9697","6433","0925","8429","3451","1735","0511","0103","3893","8909","0099","0644","7473","8979","5307","4773","0689","2767","0136","4313","5087","2353","0231","0063","4915","2997","2177","9761","2705","2093","5231","2865","9591","1711","7461","1543","3091","0275","0294","2067","9693","9935","9279","3895","0791","2089","0009","6941","0007","0068","8889","6441","2973","5501","1667","5985","8589","0553","1041","6871","5767","1199","9517","7231","4575","9427","3921","9503","5709","0611","4237","6643","0361","3745","5457","1072","4311","7163","4675","0902","7567","4793","6995","6299","9027","3561","6819","8115","7543","0161","1505","2725","0719","2635","1283","0711","9561","8907","8743","7397","3031","0114","8331","0085","0910","3743","9371","1009","8715","0393","3083","6669","8991","2827","4743","8899","4045","6247","7103","0394","6241","0693","9541","7213","6641","4357","1745","0969","4639","0763","7981","0864","5737","4795","3449","9111","7355","5927","5515","2331","0291","9671","3389","9383","0815","3545","5093","4195","4071","3825","0134","1455","5203","2551","0124","8871","6587","4873","3445","3687","0728","6417","9679","0053","7921","6451","4935","3017","9705","4321","5911","4483","6967","8473","8553","1245","8217","0589","6869","1807","4209","3801","6531","3305","4201","4771","7909","2117","3585","8927","4317","0666","0828","5987","0561","6597","5085","5247","0801","9365","6183","0513","0244","0162","0200","4579","3151","9757","2375","7669","3101","0403","5541","6437","0502","6803","4557","6147","9893","5733","8261","5079","6953","8419","8663","4625","7843","9269","9635","0478","1801","0943","7059","0329","4081","7953","9869","5097","0079","0466","5625","3173","8107","1192","0437","7737","7899","1697","3081","6057","1323","4623","7961","7471","4697","8163","4693","3507","4443","7009","2113","7861","2395","5695","5815","1062","0368","9075","0894","3319","8699","7536","7515","1927","7839","4739","5305","3221","0672","1385","6113","4439","1903","3371","1249","2961","0959","2751","5706","4825","0518","2941","3631","0285","1345","0386","6237","8643","9539","9905","1381","2033","0809","4683","7863","7901","6269","0107","6305","8343","5691","7197","8135","8295","6989","0375","4613","7753","2489","2975","0178","9068","5213","6187","6431","2307","2101","2261","6581","0093","6167","8319","2445","8439","0872","2279","2197","6193","4681","2431","4225","1205","9439","9315","9597","9595","1191","9631","0434","4491","8649","9665","1303","0952","1743","0315","4473","5411","9895","7159","8053","6827","3399","6131","5391","9995","6811","7749","6851","7379","3459","9291","4067","4597","7207","6002","0149","1533","2532","3939","3527","6785","8373","3025","5879","8365","6611","7345","5793","6115","4519","4107","9367","9037","0858","6913","1039","0835","0036","0362","3593","2123","0838","3997","3015","0483","0380","3867","8475","1297","5659","4883","1375","0498","4269","2189","8551","9285","9283","5529","9313","0993","8823","6293","2947","0619","1679","3633","2327","0998","4403","3587","0138","3133","0153","4963","6675","9405","4019","4423","9601","0240","6495","0825","0598","0781","4165","0472","4243","7505","3099","2731","0832","0628","3379","0441","3621","0353","3859","5325","2999","0429","3281","5645","5563","6745","3195","9799","2049","9349","5311","4169","0588","9211","0664","1539","7819","3251","3577","0658","0082","1138","0709","2297","1887","3599","5107","0396","2207","5755","2533","0432","7343","1873","4197","0098","8803","8189","5577","9451","0111","2761","5289","7897","8671","2553","7243","2183","0694","0648","0911","4661","8001","6327","5673","0228","2409","8933","0184","2283","0382","6887","5785","1133","0599","1537","1251","7205","6383","5241","0875","4829","2789","0194","0537","6283","2653","0083","3547","6315","1217","9903","6517","6963","3781","7125","4715","7733","0534","3613","8913","4091","3315","8937","2085","1349","2613","8561","0300","4191","2883","2427","6831","1643","8413","3395","3353","7877","0882","5387","6977","4977","9259","3589","0058","3951","8965","8145","1001","2469","4261","7605","0059","7033","2953","3645","1279","7395","7431","1231","9469","2535","1084","9301","6813","1158","8151","6721","0296","4965","0967","8917","4551","9811","8383","3811","8783","2665","4989","8939","9915","5825","8311","6143","1125","3489","4997","5811","0713","0732","4953","1769","2909","7803","2133","2009","9879","9141","6155","8765","3095","5947","0050","5005","1983","7731","6507","9889","1813","1845","2863","2251","6165","3513","0207","2401","7783","7821","8677","1762","4187","7937","0881","4469","0141","0404","2293","4615","5429","0331","6039","5301","5829","8969","3665","0565","7108","8921","1865","8507","1451","8829","3607","6863","6943","6739","6411","9347","4125","1168","0964","9345","3105","9791","4489","6487","1059","0813","8845","9985","9617","5783","1335","7245","3003","7325","5121","6261","5973","6053","4911","4339","0867","6535","1437","4085","5919","7795","0655","4203","1877","6769","9827","9471","3265","6567","1337","6631","6015","4175","2337","7551","5999","4121","2405","3057","7745","5379","7865","7619","3863","6387","6711","7649","8381","2465","1321","4215","7763","5273","7351","1044","0390","2285","5425","3793","0102","3383","8109","7209","3373","8755","4717","1026","3409","8177","7155","4095","7111","8108","6945","7147","9511","5065","3385","9543","8277","2363","1913","2929","4111","7455","8187","4229","9121","1371","3935","2425","2545","8173","9965","3927","5797","9099","0697","9343","8975","7547","2447","1631","0651","5789","1541","0092","9817","9033","9031","4705","5235","3765","0236","8617","6779","4657","2657","0087","0308","4241","8931","4567","0199","7171","9943","7533","5409","2225","0061","0530","1117","5071","7065","5881","6409","0617","5511","7873","9051","0546","8723","9657","2311","0740","4919","0900","1529","3567","3933","0707","8619","9801","7761","5185","0575","2491","9505","6609","1042","2121","0754","8727","7787","3219","6031","5827","2885","0580","6227","5899","6021","0187","3815","7891","3199","3069","0295","1763","0028","7139","1551","6525","8399","8841","4513","0290","5245","1220","1237","3113","7353","9351","6041","6773","0613","8525","4161","1549","7177","4157","0788","2601","0990","1905","7123","3981","1901","4591","0652","5077","9399","6865","1885","2945","0476","9589","6853","7259","0508","5871","2893","9377","7419","1257","2355","8633","3901","4227","1207","1329","6019","1390","4877","8301","7685","0383","8741","9147","4611","8481","4233","8513","3415","0681","1619","5857","0837","2509","2539","5271","7713","4039","8153","1034","7741","2517","1415","9407","0475","0616","8097","7443","8047","7189","9065","3967","7267","9385","2737","7385","8483","5991","8397","3827","3171","3701","6551","2267","8139","5405","1367","0265","7725","0402","8701","0562","6453","8287","9711","1717","5057","3791","1545","1339","5621","5945","3661","0683","5697","0292","1085","7527","3367","3729","6419","1809","0013","0705","0192","9181","2125","9629","7833","8401","4117","4769","3747","0218","0336","9731","4429","1851","4171","2091","3763","4495","0804","3677","1595","7955","4365","3263","4647","5909","1993","6231","9045","4387","1241","4543","7233","5519","2377","0091","5555","7507","0201","6685","7541","7051","8641","6519","5333","8881","1703","8879","7329","2027","2595","8019","4837","3731","4379","3317","0602","4249","2043","5059","5181","1875","7583","8235","0668","6555","1291","4103","9115","0587","1565","6741","7757","8121","1023","5835","9953","1347","0117","1177","6601","5049","1377","7413","4515","1617","9485","0387","0183","3201","8501","0179","4665","3441","2543","2053","6251","9734","9751","6731","0039","3215","2786","5415","9289","1131","5779","9487","8827","6621","0482","4905","3885","0457","7227","3597","1048","1517","8491","1513","1431","9873","2815","0731","9131","9535","7087","6229","3125","8957","7407","3079","2911","1481","0358","8207","1589","0975","4931","4399","1501","3619","7697","2599","9897","6795","0818","7853","7035","2793","5479","8129","4703","7597","4943","9429","6737","0108","3387","9623","4559","0233","5655","0822","5937","3283","0364","6297","4583","5315","7721","0541","0070","9061","9833","9789","8239","5873","3261","7133","0973","5581","3337","6885","7659","8961","0843","4305","4017","9887","9151","4821","4331","8611","3431","4401","4033","1116","9047","7577","4027","5657","7653","0006","0042","6423","0507","7683","6987","5557","2249","3757","2529","0977","9743","0607","3499","4803","1577","1699","0944","2269","4265","6539","5723","0461","7595","3309","6245","0554","1002","6895","0775","3503","5337","9899","3001","0164","1407","3485","0160","2505","8661","5439","2741","6163","6529","6363","9421","1101","0569","9661","8269","6717","9327","9857","7117","1092","3721","3349","0104","1833","6971","9375","0359","3783","5739","0252","4713","5401","0095","7191","3029","5473","9467","3467","0916","9621","0750","7907","3255","6273","4679","9083","9855","0984","7399","3521","7593","8445","2205","8605","4363","7297","6889","5175","5459","3823","0734","1443","4459","1052","7557","6085","5269","3063","0836","2039","0224","8809","0937","9011","1095","2479","6719","6515","6345","0431","6301","6707","9479","9845","0299","0846","0661","4167","0127","5551","9499","3299","4971","3135","0239","3991","3011","1985","2755","1613","4465","9725","9275","8213","0219","5969","4827","8537","1399","2701","2333","9913","1919","3833","2321","2887","8181","0860","9319","0606","2747","0173","0356","8533","2537","4901","3267","0268","5711","0710","3909","5619","9575","8433","4925","9287","6757","1495","1493","6753","0040","6217","0810","7315","8253","8781","4131","6007","2209","7633","8159","0695","1957","4689","8645","1036","4235","5499","1146","4955","0917","1855","3443","-100","0156","7025","8125","1187","9137","1959","6975","0182","9297","0691","7053","6767","0302","6725","0443","8843","1785","2639","5369","0820","9119","0469","4585","2055","9841","5635","5431","3879","5141","0369","5997","2081","7625","4849","4645","4435","1045","2471","0227","9523","0999","5607","6545","8171","1725","7717","8243","6407","5255","0748","5743","7573","3209","7775","5001","5569","9273","9109","9593","3189","7307","1046","9627","0001","1469","5705","7581","7247","9325","4185","2877","8541","3769","4991","6499","6171","7149","5395","4049","8493","2415","8205","9917","8775","0169","0918","9215","7093","7459","4563","6765","9087","4395","0395","5819","0517","3043","7361","1201","9233","5317","0015","4741","4333","3965","5839","8449","6369","0802","0453","0674","1265","5017","3875","1122","0468","1343","4275","0420","9167","8757","0797","4141","0814","1853","2625","2459","4457","9389","8245","1795","5461","6067","1783","0273","5491","8059","4021","0471","6179","1605","4947","7679","2621","9553","6289","9303","0310","7831","9583","0325","3667","8887","0603","1194","6591","7079","1083","3937","5567","9317","2669","0568","5237","6701","0417","1353","5145","7265","2165","5019","0855","5299","9643","1239","0972","2661","0030","1166","3511","1061","2119","2037","8315","2931","5377","8515","8759","6393","8023","3985","8837","1102","0755","1611","6789","9603","3605","1157","9185","8165","1843","9425","0981","0958","9909","0222","9169","0481","4967","8471","3241","2547","5891","8745","9477","3971","2949","6373","6491","2167","1227","5669","6195","4193","8469","9937","3411","0389","2833","8461","0997","0057","1014","0667","3685","1681","5837","4037","8805","9987","3541","6477","8679","1949","0622","0845","0904","7651","9853","7201","3897","4631","3365","4629","0181","5727","0259","4011","9717","2781","5547","2651","0220","5865","5373","9695","6065","7043","3453","5981","5367","3733","0776","7811","1142","8539","6825","5313","4089","5027","5761","6045","0741","8367","7303","8443","4975","4893","1671","4279","2851","0281","8351","5129","4109","0479","2023","6509","7895","3523","2951","5477","8371","4047","5513","0720","7225","0167","1553","3551","3753","5627","1831","7091","0054","9373","5579","7373","0540","1047","0595","6791","7525","6709","2915","1731","6705","8377","0789","8333","0884","1963","8689","9055","0340","7579","6029","0115","4599","6637","5365","3447","8341","9685","5851","2423","0278","0848","0297","4373","8853","0626","8027","1379","1295","2151","5413","3821","9039","4063","9445","9931","5033","1811","5191","0112","6695","5949","4847","4887","3417","2271","0982","6465","0551","2223","3363","1359","1561","6291","1519","3109","9267","0146","1509","3179","1547","4767","4761","1070","1659","7611","4385","2175","0951","0257","3397","8615","0232","3229","7629","0552","0163","1160","0119","8029","7417","2111","2437","6547","4057","2179","6501","1134","1029","8737","1355","2619","9919","4897","8281","1791","8559","0807","7781","3375","5169","0519","3247","0473","7487","9443","8255","7477","0339","0726","0888","9103","4369","0859","7665","6071","0416","0496","3106","7979","4307","4633","3285","7933","2585","0766","0905","1006","6939","7587","0489","5133","8681","1663","8265","7851","2507","9395","9475","8821","2173","6781","8085","6983","7509","0758","7263","9669","9831","0571","3751","8847","6969","2561","7699","7855","0942","4223","6537","4659","4819","2329","8893","0226","3345","5747","3911","8063","4961","4673","1691","0261","1727","1313","1475","7671","3347","8851","0081","0262","7701","5007","2801","0166","3161","2343","4545","8093","2381","7519","8211","5223","4361","5339","7251","5171","5701","5537","2681","4145","1188","8427","6101","3693","9891","2629","6461","3277","2011","3683","3065","6367","3145","0407","3873","7253","8799","5699","4393","7115","0038","8011","6665","4541","5803","0968","8859","0853","4315","6843","9981","0742","2229","9201","6141","0877","5601","8575","3311","0301","6337","5929","5683","8293","3805","9675","0049","0287","2163","1387","6729","4281","3341","2807","1665","1827","4641","1011","9983","4353","3291","9605","9481","9521","2745","2417","7759","8607","2367","7627","6239","0590","6317","6309","1655","2919","1144","7439","0688","9793","8039","4041","2567","9947","3419","1112","9165","1020","2667","2991","4051","1723","2047","8691","6243","9093","3995","4115","2715","0919","4507","0549","8257","6951","0730","4135","4949","9759","9021","9101","2939","3673","8199","3671","7173","5331","5043","3695","4427","8831","3279","7479","3603","5433","2087","0026","1309","9829","8359","3175","8719","1741","1657","1167","5609","3325","6829","3725","3071","5069","9677","2659","6287","3795","6033","0363","1259","6805","6353","9491","5861","9979","6673","8545","7645","8379","7807","1115","6823","5925","6903","0314","8651","6037","0630","7257","9173","0384","2441","9413","9453","3539","1907","9611","2351","8221","1895","0263","0446","2587","5931","7603","9029","7639","1847","7475","5679","2253","5719","3475","2369","0123","0447","3709","1629","5177","0527","6275","2195","6961","4267","5123","5693","1981","0206","5595","1759","1839","2899","5343","2689","5703","9861","2193","3293","3575","8581","9599","8941","2699","0150","2005","7061","1269","1057","7295","6679","9081","0067","9773","1186","8669","8219","5647","5521","1483","6947","8087","7677","8735","2821","0251","6079","8361","8523","9379","4933","1341","1421","7007","8919","0048","0698","8099","2347","4099","5239","0196","0213","2211","0985","0411","7711","0388","4485","3053","2763","0662","9369","2721","8591","9363","0084","3571","1939","7235","1056","2339","6619","7883","3641","5639","0499","2823","7219","7871","7381","0077","9243","6713","3775","8057","7975","3525","9885","3155","9271","2907","5109","0581","0438","5025","2739","1305","8521","0874","0157","0868","0113","8347","5773","7363","6177","5399","4861","9423","9663","2565","1135","6475","2803","0965","8873","9933","1327","2019","0078","8987","0987","2779","0066","0634","3957","2813","2971","0174","9941","9125","6759","2433","0940","0633","1609","5805","0686","7837","1189","0495","3023","7709","3465","2607","5135","8275","1953","3583","4561","5453","6877","1859","1123","1441","1195","6331","4735","5099","9339","6117","3425","3505","1995","2481","1053","6635","8103","0528","4137","4196","0663","1601","6447","5549","6405","2769","4481","5291","8349","2555","7041","2797","5895","5283","5731","0585","7681","2663","1153","2825","8453","8655","3719","0455","0777","0062","0796","8563","8155","4113","8597","7903","6595","0023","0223","6911","4747","2421","6377","1401","1563","0621","4451","0209","1004","1267","3183","0245","3829","6763","0012","8141","8017","0347","6463","6625","5483","8335","0953","9431","8003","1599","8977","2287","0512","9097","0348","2693","9217","0037","7825","4759","8835","4593","4347","1979","8543","9929","4461","5195","7723","3723","2783","7799","0129","7549","1124","8647","8973","6403","5993","1139","8479","4397","1459","0538","3533","2061","1447","0692","6993","0514","5877","2449","7097","4119","5179","0216","7655","1190","8387","6793","1491","4179","0139","6455","9513","8571","3595","6449","6693","4159","2527","0670","0912","8885","7987","0401","6355","3579","2069","4271","1110","1007","1945","3535","0065","8547","1695","3651","4995","0345","1281","0995","7561","0505","1033","1971","1235","1031","0623","9105","3435","4903","0657","6121","1103","1591","0020","9419","1017","0996","3789","0485","7249","9241","3041","0913","4501","5597","3473","8897","6001","6571","4123","9261","9095","2365","5505","9133","4035","1503","9741","2563","2071","4719","6513","8185","5207","6389","0839","9035","6055","0385","2709","0608","0625","6211","1149","8485","0878","3343","9457","2115","3785","1825","4843","5535","1701","4391","5527","3977","1285","4749","4257","0850","7435","2497","9225","2169","1879","1917","1467","0140","4687","1747","2685","1787","9127","4351","2065","0351","3773","1140","4053","2171","6861","5229","8567","2775","2977","0060","2485","3259","3421","9249","8431","4839","5573","1104","0288","5157","6013","6257","8499","4499","5681","7923","1395","4535","6735","7793","3591","0752","2643","8839","6023","6267","2881","9691","8587","3039","3809","8131","7393","5923","0762","7715","4207","5345","7221","6313","9001","0069","0191","3697","7449","8915","4505","1037","2097","6991","2213","0821","0596","0289","3143","2041","5221","7585","1038","1749","2075","1789","0786","0946","0334","0088","8673","0799","8303","1771","3481","0768","3601","9063","3797","2735","2325","3913","5013","1301","9293","4845","0887","0841","2757","7977","0452","5443","1277","8903","1969","6249","0354","5183","3141","0243","4031","9577","0706","1989","9207","3085","8997","7359","5275","6577","4781","7553","2291","2453","1841","8447","4323","6933","5219","2237","8639","0399","8309","4149","3169","1089","0639","3289","8951","1100","9967","4987","4701","4003","8855","0573","1511","0834","2159","2157","0933","0096","8557","5905","7167","5045","0225","1897","3119","0019","7929","8417","7069","1315","1151","4005","6979","5957","2691","9783","8923","1173","8065","1863","0414","1453","0433","8953","5771","4587","0427","5481","4907","0110","7063","9877","1025","3635","8529","0350","6569","8811","0653","5423","5091","0418","9859","4841","7531","9527","8421","0221","8703","6663","7437","0217","7313","8169","0152","6859","3881","1515","6205","5021","5061","1000","4731","7341","1223","6479","4969","2917","2713","7483","2503","9835","4245","0737","6527","4895","1751","0323","1261","5419","9003","7003","0717","6139","9401","4303","0366","2955","1729","8947","5553","7143","0005","7915","6075","9737","0963","0738","0593","6425","7441","7889","9639","1645","0745","4617","9509","8815","3185","8731","1307","6607","9135","5381","9865","7377","1156","5661","6191","9613","5371","0313","7939","0761","2589","0957","0120","9681","0198","3843","9307","0230","1837","5791","0895","6645","5421","1463","2641","8595","1171","3903","6225","9689","1775","4589","9153","3647","2743","8779","4251","8043","3515","2861","8407","0594","0247","3711","0954","3543","3899","1165","7485","5603","0503","0171","7185","3351","1393","7997","2083","1063","0449","6485","0876","1507","8519","0645","5293","0643","3659","0147","6749","9073","0080","0751","6133","1973","7555","3883","8083","8773","9547","2031","3287","9649","0526","6335","1008","5757","8527","9341","9585","5139","2403","8231","4763","7085","8143","2187","1287","0772","9193","9723","5889","9231","2131","0333","6897","0186","8279","2201","3339","6761","2315","8183","3777","5897","0330","5081","1409","9563","4015","6661","2623","5763","6617","3923","9305","1923","1086","5917","6649","7463","7299","7869","0439","9813","8263","3855","2015","5355","3679","5227","2983","4083","7995","2239","2483","9129","1150","8631","0309","0778","4957","2673","0673","7401","3975","9847","3117","6051","1523","3643","0051","0764","2413","5471","1921","8895","8079","9299","1076","3703","5495","4553","5041","4345","8625","9052","0486","3157","7845","8777","1473","4001","6733","9179","5671","5831","1099","1074","8353","8391","7777","5941","9157","7523","2463","5561","6087","9145","6533","5633","5509","3429","8363","3713","6035","2241","1829","3093","0155","6511","2385","5199","0467","8867","2749","7643","6783","7801","5841","5629","0857","2487","6435","5863","3127","9567","0574","0021","8825","0869","9923","1521","0175","8943","8045","7675","5961","8119","4733","9015","5751","6565","0548","0241","6807","9253","0729","0708","2889","9781","3047","4595","8875","0412","0696","8423","7319","1077","8123","5593","7999","1126","8569","1145","1185","0304","8603","3953","3257","5253","4147","3737","3123","9767","0305","9235","2057","7071","4173","9107","4009","3191","4573","3959","0939","7827","1909","8105","0883","6959","6061","6589","9199","2021","8785","4421","9559","6703","7599","4043","9059","1961","0897","6647","0506","0424","9007","2277","1175","9205","0986","9975","1817","7771","4219","2871","7885","7027","4537","3231","9673","1271","1637","7183","3837","4325","6445","8321","7423","5341","1181","7501","8111","2359","1869","0277","5903","2925","6839","5125","9771","2511","9647","2995","0322","8659","8411","1170","2615","0426","2443","0464","5623","5983","7451","9651","0654","2591","1163","2671","0854","5807","2707","1172","6493","1219","0014","0462","0685","9739","0052","9525","1733","8949","6949","0892","5847","8865","0076","2217","7967","8209","0928","5921","0249","5631","0960","3181","0344","5787","1707","0376","6837","5285","2063","8505","7199","0324","7073","6623","5277","0135","9921","5189","1967","8531","7623","6025","4635","5205","6671","0898","7887","4823","8901","9837","0190","0903","6285","8077","1263","8357","9825","8601","0035","6109","7409","2963","3203","0795","9805","3361","0442","8007","0829","3147","0863","9019","3717","1143","0367","4077","4809","0180","2525","6399","2035","9823","2399","0256","6189","5047","2559","6677","0008","3045","0597","3207","9569","6263","5977","8791","3529","2387","6457","1433","0556","9263","0022","4891","7131","0723","6799","0311","7203","6303","0532","0980","0280","0564","1397","2373","0842","7835","0043","0165","8403","6893","4609","1040","3955","7911","1423","2727","3501","8395","7129","0397","8999","6919","7857","1777","1369","3611","3609","6259","3403","0871","0806","3799","1555","7875","6443","7829","0712","5583","2967","5575","1781","0492","5321","5769","1119","1525","0770","0566","4909","3073","6049","9189","1317","3925","5267","8285","2571","0491","5257","7867","8925","8067","3907","1211","6755","3329","5689","0591","9645","2051","6047","4129","8819","2577","0272","0659","8935","9993","5259","3831","7949","3217","9945","8555","7005","3087","4921","5939","2105","0494","1615","5039","4383","9807","4709","3891","6909","0669","4497","4007","4699","7511","7673","7137","1427","3993","6397","0523","2397","7535","9533","1947","6349","0923","0576","7773","0105","3121","0932","1805","4983","7101","5143","1635","3225","9177","9911","8197","8767","4729","9989","2521","0370","2837","7893","1815","4833","1439","9023","8369","7347","1675","0064","6691","5951","0811","7621","7943","4721","6107","8267","0130","2597","6307","1005","4797","8833","9729","6751","1449","9687","7769","0488","0646","6579","0316","5349","9749","7667","7055","9089","5989","4805","7823","1213","3741","3531","6833","9851","6627","7727","4503","3483","9963","0133","9549","0474","1881","5261","3097","5173","7371","2679","6999","1653","7565","8013","0459","8489","4857","9459","5907","0605","3377","6553","7571","3491","4183","8015","9359","8175","8621","8089","5559","8577","1765","9959","2451","6119","0592","4445","8355","3989","1032","2477","0578","1209","3857","3569","1161","4463","5197","1603","4865","0234","6653","9507","0493","1019","5095","2811","1154","2393","5611","8751","7935","0286","5525","3519","9839","5637","0722","4447","0510","1162","9787","0687","1333","8795","8345","3205","5485","1975","4013","9149","0808","2457","7919","5063","2575","1021","3835","7545","9867","1871","5215","1951","3131","2677","5735","1289","7077","2139","6747","7029","3275","2495","0615","5101","8037","1797","6563","5665","6153","0075","9615","6921","4757","2513","5571","0002","8179","0185","8627","1403","9721","1010","1193","1233","6899","1719","5103","3061","9463","4487","3303","0346","9703","4605","0769","9537","5335","9329","5943","6879","1531","0204","9437","7357","6375","0501","5843","8451","3393","2903","2493","9997","8609","4441","8721","9659","7985","3865","0193","0212","8797","9531","5083","0208","9323","0757","5935","8911","8503","3159","3321","5753","0716","3509","0205","8157","8031","7089","4151","7411","9449","4677","0210","9117","2221","4093","4581","0901","2245","3223","3915","2073","7905","0624","2723","3129","7447","3817","1043","9361","3405","9765","5359","8091","2787","1113","3477","8697","6127","1965","0312","3391","8325","8813","1581","2845","0988","3333","5859","0267","0246","6667","0406","9763","1132","4619","0642","1111","6981","8693","4533","4247","0535","4449","0880","0756","0264","8971","9785","1299","6151","0929","3905","4025","0025","1079","3851","5641","0337","0680","1757","0817","8891","9175","0405","4319","0893","7663","1137","3295","5211","0704","7489","7569","6549","9159","0408","1445","2259","9374","0703","3469","3999","8117","5833","7301","1793","6561","7457","2275","3537","0824","3495","3657","6185","4105","6427","2593","1184","6343","5445","2501","2419","8005","5517","9961","2617","3555","7021","9875","2003","7223","8033","9779","1129","2107","0515","2429","7689","4059","3239","0017","1647","9355","1641","6615","9633","4691","6197","0283","9907","1709","5295","8883","3617","1169","3779","0271","1857","5115","2137","9881","0718","4529","7383","0567","0260","1623","6639","7169","5781","8225","5979","0856","2263","3853","4627","8583","2791","3313","7879","1391","8241","0714","6199","4565","0321","4521","7049","3007","1253","4801","0803","0456","2921","4917","5855","0122","8869","1180","1159","4377","3969","6207","7145","9257","2609","0121","9337","9417","1911","4479","0584","5009","3663","6681","3457","7165","4349","5613","7323","1571","9483","7403","0425","6867","0949","1479","3639","5677","0373","9951","0504","4725","0544","8271","0317","5493","8511","7037","3407","9973","5813","5933","9195","2499","1683","2007","1130","4127","0436","9755","6857","5225","8237","7421","9581","6521","6847","1625","8025","5249","2515","3249","1575","7691","0612","0936","6583","8459","3931","9557","7433","1477","3549","0428","8195","0931","3983","9977","4143","6997","0143","3813","1176","8455","2867","0583","0398","0743","4859","6081","7957","4285","5303","9013","7993","3669","5463","8073","4807","7375","3945","0782","4799","4431","2103","0631","0896","4871","4055","3565","6379","0812","0783","6613","2901","9955","3877","2733","8801","1417","2843","4875","2467","1325","7849","1098","7317","0440","7963","8409","7335","3705","2969","6149","4069","8635","2557","3413","8629","0572","2219","1178","0116","0379","0861","3919","3715","9139","6771","1713","6687","8477","9333","0094","9901","0500","8385","6181","5119","9277","1893","1689","6175","6541","8375","4945","0865","2129","5147","3433","2943","1147","3675","2935","6845","0971","8593","6145","2719","0250","5449","1819","8137","5361","2095","0320","0238","0377","7635","0211","8323","4815","5011","1419","0332","1779","1411","6223","0879","4343","9237","5117","9069","0749","3563","1174","3111","2127","0516","2695","2897","7135","5867","2805","8229","4263","4751","8945","4785","5151","0579","1128","9713","9219","1633","6809","0195","1068","9203","9447","7815","9849","4547","9113","1849","1889","9229","0970","1639","1311","0144","2235","6311","7241","2143","8299","1607","4787","9719","0827","0577","0800","5959","4205","0125","7425","7503","8441","0773","1097","3049","4517","2029","0641","0780","0736","2141","8339","9683","0690","0343","7601","0423","4133","8415","0909","5721","8739","0011","6003","1883","2777","4979","2611","8687","2161","7789","1627","9455","6559","0033","7047","5089","2231","5329","4999","7729","8707","9519","4297","2013","1685","0276","4415","4211","6821","0106","0327","4607","4851","0172","0679","7121","2633","4509","6221","2993","9925","5437","4375","4653","2857","2979","2407","9991","3137","4601","7045","6351","9245","2473","8711","0391","6059","2959","4753","8789","4913","4707","3767","7391","2985","0823","1557","6203","0735","9625","7217","0790","8435","1867","0477","9123","2145","5163","8995","2835","5035","7971","8989","0215","0684","0480","5801","2247","4407","5749","4973","9255","6359","8069","6723","8147","9085","0010","9777","9775","5003","2675","0284","5111","5233","4253","5067","8857","7057","8807","8071","1705","9493","0214","3089","7615","6473","0536","1066","6347","2795","5159","2873","1058","6173","4419","7925","0419","2295","4291","3963","0018","0563","3819","0635","1060","9441","2627","6907","6905","9311","1069","1673","5745","0950","0542","0725","7331","9529","3165","4711","3771","3689","1071","8983","5187","9753","2289","0941","5589","8763","7333","9411","1621","7529","7157","2059","5685","7719","8329","5263","8929","4155","3213","7453","6105","4555","7327","8061","4023","0086","5281","6421","4299","4783","7107","7841","3761","8729","0733","8437","3949","0992","6557","1091","0656","0524","3235","0930","0253","8161","1389","3177","4685","4603","8191","2603","5417","0176","1064","2185","5161","7767","9071","0484","0522","1929","4985","5643","5887","3807","7517","3479","0724","7881","1090","9797","6817","4329","6815","0840","9465","7181","9057","5053","0586","8599","0132","7941","7859","0435","4124","1935","8133","0255","6413","3027","6043","8201","0533","5427","6077","1141","2771","8317","4927","6841","2025","3655","4511","9803","2989","8981","5759","3187","1107","5707","8725","0609","7255","8149","6271","0254","1661","7735","2637","0555","1737","4425","7687","0793","7195","0444","2869","9957","6325","7099","0409","6483","4199","4309","1413","7081","6265","5407","3243","2301","3973","0282","4745","3845","6083","4777","4163","2569","0792","2847","3947","8101","1941","3979","1899","2345","1567","8457","2703","9265","5713","3021","7537","9735","9571","8713","0614","9971","0509","1649","5605","0547","5441","2299","0137","7641","1054","2461","3233","3557","0926","6855","6323","4283","6727","6683","2191","5127","7609","9197","2875","4139","5403","1073","8985","7187","6697","6573","5543","3463","9497","4029","7493","3163","6219","4669","3323","5809","7113","5029","0131","0430","0031","1497","5451","5653","1203","0774","8051","8497","3559","6169","1559","4087","4413","8817","6361","6523","2933","0649","7293","0885","2475","3487","6505","2383","8337","1891","4337","7965","5599","2455","4289","0739","5875","9461","2435","3167","6467","0145","5363","1243","4789","5319","6009","1275","9187","6575","0392","8565","7015","9335","4765","8761","5251","3005","2923","6469","3369","1003","0410","0328","6137","1363","3035","4255","5435","6699","9227","0947","0701","3107","2371","3961","2819","0188","1164","5915","6157","8113","5663","1583","4881","3331","5533","3735","2265","0938","8095","7481","2379","6333","7105","1721","1109","8613","5675","1065","1183","9501","7991","6277","2891","0342","9863","7497","3987","0601","3739","8959","0004","0269","7039","0978","4341","0629","0177","2583","9309","0415","3471","9545","0470","0422","5209","3573","8585","9155","1687","6743","5397","7797","9017","0899","1225","2243","5667","8685","0935","2361","3013","3623","6395","0229","0677","1247","7239","0448","8049","3929","4539","6371","4371","8327","7427","1120","2853","1055","9331","7127","3455","6063","1535","0961","4221","1937","1121","0570","7563","9843","8695","0497","5105","1799","4409","2859","2895","0203","5953","5585","9295","0525","9171","3869","9819","9573","4923","0374","0862","8305","9281","7973","1651","2341","2829","4867","0318","1050","6655","0945","4079","1997","1955","6849","1383","6069","2683","5823","1987","3943","0700","1127","2799","0046","2391","2717","6835","3245","2181","0465","2135","5153","9883","1094","5353","6125","7389","1229","0371","7179","7095","6891","7339","6319","7785","9005","1293","7693","5893","0326","6341","0650","8215","7559","2257","9353","7067"]
    codmunicipio = ["9701"]

    for cod in codmunicipio:
        driver.get(url_base + '/consulta/Cons_PorMun_Ped.asp')
        driver.find_element_by_xpath(
            '/html/body/form/div[4]/center/table/tbody/tr[2]/td/div/center/table/tbody/tr[2]/td[4]/font/input').send_keys(
            cod)
        driver.find_element_by_xpath('/html/body/form/div[6]/center/table/tbody/tr/td/div/center/p/input[1]').click()
        rips_urls = []

        if driver.current_url != 'http://spiunet.spu.planejamento.gov.br/criticas/erro.asp':
            table = driver.find_element_by_xpath('/html/body/form/div[5]/div/div[1]/div[1]/center/table')
            rows = table.find_elements(By.TAG_NAME, "tr")
            for tr in rows:
                cols = tr.find_elements(By.TAG_NAME, "td")
                for td in cols:
                    if tr.find_elements(By.TAG_NAME, "a"):
                        url_rip = str(tr.find_element_by_tag_name("a").get_attribute("href"))
                        rips_urls.append(url_rip)

        acessa_rips_municipio(rips_urls, driver)

def run(link, user, pwd):
    if link is None:
        return

    driver = webdriver.Chrome()
    driver.get(link)
    driver.switch_to.frame("Principal")
    driver.find_element_by_xpath(
        '/html/body/div[2]/table/tbody/tr[2]/td[1]/center/form/table/tbody/tr[1]/td[2]/font/input').send_keys(user)
    driver.find_element_by_xpath(
        '/html/body/div[2]/table/tbody/tr[2]/td[1]/center/form/table/tbody/tr[2]/td[2]/font/input').send_keys(pwd)
    driver.find_element_by_xpath(
        '/html/body/div[2]/table/tbody/tr[2]/td[1]/center/form/div/table/tbody/tr/td/p/font/input[1]').click()
    consulta_por_municipio(driver)
    driver.close()
    driver.quit()

if __name__ == "__main__":
    user = input('CPF: ')
    pwd = getpass('Senha: ')
    run(url_base, user, pwd)